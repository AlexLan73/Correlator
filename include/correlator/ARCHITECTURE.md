# üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ FFT Correlator - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## ‚úÖ –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã

### –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (I-prefix)

1. **IConfiguration** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ç–æ—Ä–∞
2. **IDataSnapshot** - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. **IFFTBackend** - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å FFT –±—ç–∫–µ–Ω–¥–∞ (Strategy Pattern)
4. **IDataValidator** - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
5. **IResultExporter** - –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ JSON

### –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **Configuration** - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
2. **DataSnapshot** - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
3. **OpenCLFFTBackend** - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è OpenCL (–∞–¥–∞–ø—Ç–µ—Ä –Ω–∞–¥ FFTHandler)
4. **DataValidator** - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
5. **ResultExporter** - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞
6. **CorrelationPipeline** - –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏

## üìã TODO –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

### 1. OpenCLFFTBackend - –º–µ—Ç–æ–¥—ã –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

–ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –≤ `FFTHandler` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:
- `getReferenceFFTData()` - –ø–æ–ª—É—á–∏—Ç—å reference_fft –±—É—Ñ–µ—Ä
- `getInputFFTData()` - –ø–æ–ª—É—á–∏—Ç—å input_fft –±—É—Ñ–µ—Ä  
- `getCorrelationPeaksData()` - –ø–æ–ª—É—á–∏—Ç—å peaks –∏–∑ post_callback_userdata

–ò–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ OpenCL `clEnqueueReadBuffer` –≤ `OpenCLFFTBackend`.

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ OpenCLFFTBackend

–î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```cpp
void setConfiguration(size_t fft_size, int num_shifts, int num_signals, 
                     int n_kg, float scale_factor);
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ GPU

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã `getDeviceName()`, `getDriverVersion()`, `getAPIVersion()` 
—á–µ—Ä–µ–∑ OpenCL API (`clGetDeviceInfo`).

### 4. –£–ª—É—á—à–µ–Ω–∏–µ JSON –ø–∞—Ä—Å–∏–Ω–≥–∞

–í `Configuration::fromJSON()` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É (nlohmann/json –∏–ª–∏ rapidjson).

### 5. –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `examples/basic_usage.cpp` —Å –ø—Ä–∏–º–µ—Ä–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º

### –¢–µ–∫—É—â–∏–π –∫–æ–¥ (CorrelatorW.cpp)
```cpp
FFTHandler fft_handler(context, queue, device);
fft_handler.initialize(N, NUM_SHIFTS, NUM_SIGNALS, N_KG, SCALE_FACTOR);
fft_handler.step1_reference_signals(...);
fft_handler.step2_input_signals(...);
fft_handler.step3_correlation(...);
```

### –ù–æ–≤—ã–π –∫–æ–¥ (—Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π)
```cpp
auto config = IConfiguration::createDefault();
config->setFFTSize(N);
config->setNumShifts(NUM_SHIFTS);
// ...

auto backend = IFFTBackend::createOpenCLBackend();
CorrelationPipeline pipeline(std::move(backend), std::move(config));

pipeline.executeFullPipeline(reference_signal, input_signals);
```

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**: –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –±—ç–∫–µ–Ω–¥ (CUDA, ROCm)
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ
3. **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è**: JSON —ç–∫—Å–ø–æ—Ä—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
4. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –ª–µ–≥–∫–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –º–æ–∫–∏
5. **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å**: –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
6. **–ü–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å**: –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã —á–µ—Ä–µ–∑ IFFTBackend

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é `OpenCLFFTBackend::getReferenceFFT()` –∏ –¥—Ä—É–≥–∏—Ö –º–µ—Ç–æ–¥–æ–≤ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
2. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ GPU
3. –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
4. –î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã
5. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º

